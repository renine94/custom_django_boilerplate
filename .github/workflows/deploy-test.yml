name: ðŸš€ [CICD í…ŒìŠ¤íŠ¸...]

on:
  push:
    branches: [main]

concurrency:
  group: deploy-test
  cancel-in-progress: true

jobs:
  build:
    name: build
    runs-on: ubuntu-latest
    steps:
      - name: 1) Checkout code
        uses: actions/checkout@v3

      - name: 2) Test 01
        run: |
          echo "CICD íˆ´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œìž‘í•©ë‹ˆë‹¤."

      - name: 3) push ì—ì„œ branch name ì¶”ì¶œ
        if: github.event_name != 'pull_request'
        run: |
          echo "BRANCH_NAME=${GITHUB_REF#refs/heads/}" >> $GITHUB_ENV
          echo $GITHUB_ENV

      - name: 4) pr ì—ì„œ branch name ì¶”ì¶œ
        if: github.event_name == 'pull_request'
        run: |
          echo "BRANCH_NAME=${GITHUB_BASE_REF}" >> $GITHUB_ENV
          echo $GITHUB_ENV

      - name: 5) ECR ì €ìž¥ì†Œ ì´ë¦„
        run: |
          echo "ECR_NAME=my-backend-${BRANCH_NAME}" >> $ECR_NAME
          echo $ECR_NAME
